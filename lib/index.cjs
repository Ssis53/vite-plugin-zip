"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const t=require("path"),n=require("fs"),w=require("node:module");var h=typeof document<"u"?document.currentScript:null;const Z=w.createRequire(typeof document>"u"?require("url").pathToFileURL(__filename).href:h&&h.src||new URL("index.cjs",document.baseURI).href),r=t.sep,{cwd:v}=process,z={enabled:!0,folderPath:t.join(v(),"/dist"),outPath:t.resolve(v()),zipName:"",deleteFolder:!1},E=g=>{let b={...z,...g},{enabled:u,folderPath:c,outPath:s,zipName:o,deleteFolder:j}=b;if(u=!!u,!c||!s)throw new Error("config.folderPath and config.outPath is required.");c=t.resolve(c),s=t.resolve(s),o=o||c.split(r).pop()+".zip";const q=()=>{const F=Z("jszip"),p=new F,a=function(e,i,l=""){const d=n.readdirSync(i);l+=i.split(r).pop()+r,d.forEach(S=>{const f=t.join(i,r,S);n.statSync(f).isDirectory()?a(e,f,l):e.file(l+S,n.readFileSync(f))})},y=(e=o)=>{const i=t.join(s,r+e);n.existsSync(i)&&n.unlinkSync(i)},m=e=>{n.readdirSync(e).forEach(l=>{const d=e+r+l;n.statSync(d).isDirectory()?m(d):n.unlinkSync(d)}),n.rmdirSync(e)},P=function(){a(p,c),p.generateAsync({type:"nodebuffer",compression:"DEFLATE",compressionOptions:{level:9}}).then(e=>{y(o),n.writeFileSync(t.join(s,r,o),e),j&&m(c)})};y(o),P()};return{name:"vite-plugin-zip-file",apply:"build",closeBundle(){u&&q()}}};exports.viteZip=E;
